---
description: レビューをします
---

## コードレビュー方針

コードレビューは、コードの品質を担保し、チーム全体の知識を共有するための重要なプロセスです。以下の観点を中心に確認します。

**レビューの優先順位**: セキュリティ > 堅牢性 > 設計 > パフォーマンス > 可読性

> **Note**: 言語・フレームワーク固有の詳細なレビュー基準は、各プロジェクトの `.claude/CLAUDE.md` に記載してください。

### 1. 設計と責務

- **設計原則の遵守**: 「コーディング方針」で定義された原則（SRP, DRY, インターフェースへの依存など）が守られているか。
- **責務の分離**: クラスや関数の責務は単一か。凝集度は高く、結合度は低く保たれているか。
- **拡張性**: 将来の仕様変更に対して、容易に拡張できる設計になっているか。

### 2. 堅牢性と回復力 (Robustness)

- **エラー処理**:
  - `null` や未定義値、空のデータ構造に対する考慮は十分か。
  - 予期せぬエラーが発生した場合、プログラムがクラッシュせず、適切にエラーをハンドリング（ログ出力、フォールバック処理など）できるか。
- **リトライ処理**:
  - 外部API呼び出しなどでリトライを実装する場合、**冪等性（何度実行しても結果が同じであること）** は保証されているか。
  - リトライのループに入る前に、関連する状態が適切にリセットされているか。
- **リソース管理**:
  - データベース接続、ファイルハンドル、ネットワーク接続などが、`try-finally` ブロックや言語の持つクリーンアップ機構（例: Pythonの `with` 文）を用いて確実に解放されているか。リソースリークの懸念はないか。
- **タイムアウト管理**:
  - 外部システムへのリクエストや、時間のかかる可能性のある処理には、適切なタイムアウトが設定されているか。無限待機に陥る可能性を排除できているか。

### 3. テストの網羅性

- **テストケースの観点**:
  - **正常系**: 想定通りの入力で正しく動作するか。（ハッピーパス）
  - **準正常系**: 境界値、`null`、空文字、ゼロなど、仕様上許容されるエッジケースが網羅されているか。
  - **異常系**: 想定外の入力、外部システムの障害、不正な状態などで、システムが安全に失敗（フェイルセーフ）するか。
- **テストの品質**: テストコード自体の可読性や保守性は高いか。テストのためのテストになっていないか。

### 4. パフォーマンスと効率

- 非効率なループ処理（ネストが深すぎるなど）や、一度の操作で大量のデータベースクエリを発行するような処理（N+1問題など）は存在しないか。
- 大量データを扱う場合、メモリ使用量や計算量は考慮されているか。

### 5. セキュリティ

- SQLインジェクションやクロスサイトスクリプティング（XSS）など、典型的な脆弱性が作り込まれていないか。
- 認証・認可のロジックは適切か。アクセス制御に漏れはないか。

### 6. その他（可読性と保守性）

- **命名**: 変数名、関数名、クラス名がその役割を的確に表しているか。
- **コメント**: なぜその実装にしたのかという「意図」が、複雑なロジックや直感的でないコードにコメントとして残されているか。
- **ドキュメント**: ユーザーに影響のある変更や、重要なアーキテクチャの変更があった場合、READMEなどの関連ドキュメントも更新されているか。
